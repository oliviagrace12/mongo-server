(this.webpackJsonptodo=this.webpackJsonptodo||[]).push([[0],{109:function(e,t,c){"use strict";c.r(t);var r=c(0),a=c.n(r),n=c(24),s=c.n(n),i=c(6),o=c(2),d=a.a.createContext({theme:{primaryColor:"deepskyblue",secondaryColor:"coral"}}),l=a.a.createContext({state:{},dispatch:function(){}}),j=c(11),u=c(121),b=c(76),O=c(1);function h(e){var t=e.title,c=e.description,a=e.complete,n=e.createdTime,s=e.completedTime,o=e.id,h=Object(r.useContext)(d).secondaryColor,m=Object(r.useContext)(l),p=m.state,x=m.dispatch,f=Object(j.b)((function(e,t,c){return{url:"/item/complete/".concat(encodeURI(e)),method:"patch",data:{complete:t,completedTime:c},headers:{Authorization:"".concat(p.user.access_token)}}})),g=Object(i.a)(f,2),v=g[0],C=g[1];Object(r.useEffect)((function(){v&&v.data&&!1===v.isLoading&&x({type:"TOGGLE_ITEM",complete:v.data.complete,completedTime:v.data.completedTime,itemId:v.data.id})}),[v]);var y=Object(j.b)((function(e){return{url:"/item/delete/".concat(encodeURI(e)),method:"delete",headers:{Authorization:"".concat(p.user.access_token)}}})),T=Object(i.a)(y,2),w=T[0],L=T[1];return Object(r.useEffect)((function(){w&&w.data&&!1===w.isLoading&&x({type:"DELETE_ITEM",itemId:w.data})}),[w]),Object(O.jsxs)(u.a,{children:[Object(O.jsxs)(u.a.Header,{style:{color:h},as:"h5",children:[Object(O.jsx)("input",{type:"checkbox",defaultChecked:a,onClick:function(e){!function(e,t){C(e,t,!0===t?Date():null)}(o,!a)}})," ",t]}),Object(O.jsxs)(u.a.Body,{children:[Object(O.jsx)(u.a.Title,{children:c}),Object(O.jsxs)(u.a.Text,{children:[" ",Object(O.jsxs)("i",{children:["Created time:  ",n," ",Object(O.jsx)("br",{})]})," "]}),Object(O.jsxs)(u.a.Text,{children:[" ",a&&Object(O.jsxs)("i",{children:["Completed time: ",s]})," "]}),Object(O.jsx)(b.a,{onClick:function(e){L(o)},children:"Delete"})]})]})}function m(){var e=Object(r.useContext)(l).state;return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"To-Do List: "}),e.items&&e.items.map((function(e,t){return Object(O.jsx)(h,Object(o.a)(Object(o.a)({},e),{},{title:e.title,description:e.description,complete:e.complete,createdTime:e.createdTime,completedTime:e.completedTime,id:e._id}))}))]})}var p=c(31);function x(e,t){switch(t.type){case"LOGIN":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function f(e,t){switch(t.type){case"FETCH_ITEMS":return t.items;case"CREATE_ITEM":return[{title:t.title,description:t.description,complete:t.complete,createdTime:t.createdTime,id:t.itemId}].concat(Object(p.a)(e));case"TOGGLE_ITEM":return e.map((function(e){return e.id===t.itemId&&(e.complete=t.complete,e.completedTime=t.completedTime),e}));case"DELETE_ITEM":return e.filter((function(e){return e.id!==t.itemId}));default:return e}}function g(e,t){return{user:x(e.user,t),items:f(e.items,t)}}c(104);var v=c(115),C=c(118),y=function(e){var t=e.text,c=Object(r.useContext)(d).primaryColor;return Object(O.jsx)(C.a.Brand,{style:{color:c},children:t})},T=c(116);function w(e){var t=e.theme,c=e.active,r=e.onClick;return Object(O.jsxs)("span",{onClick:r,style:{cursor:"pointer",paddingLeft:8,fontWeight:c?"bold":"normal"},children:[Object(O.jsx)("span",{style:{color:t.primaryColor},children:"Primary"}),Object(O.jsx)("span",{children:"/"}),Object(O.jsx)("span",{style:{color:t.secondaryColor},children:"Secondary"})]})}function L(e){var t=e.theme,c=e.setTheme,a=Object(j.b)((function(){return{url:"/theme/getAll",method:"get"}})),n=Object(i.a)(a,2),s=n[0],o=n[1];Object(r.useEffect)(o,[]);var d=s.data,l=s.isLoading;function u(e){return e.primaryColor===t.primaryColor&&e.secondaryColor===t.secondaryColor}return Object(O.jsxs)(O.Fragment,{children:[l&&"Loading themes...",Object(O.jsx)(T.a,{title:"Change Theme",id:"basic-nav-dropdown",children:d&&d.map((function(e,t){return Object(O.jsx)(T.a.Item,{children:Object(O.jsx)(w,{theme:e,active:u(e),onClick:function(){return c(e)}},"theme-"+t)})}))})]})}function E(){var e=Object(r.useState)({title:"",description:""}),t=Object(i.a)(e,2),c=t[0],a=t[1],n=Object(r.useContext)(l),s=n.dispatch,d=n.state,u=Object(j.b)((function(e){var t=e.title,c=e.description;return{url:"/item/create",method:"post",headers:{Authorization:"".concat(d.user.access_token)},data:{title:t,description:c,createdTime:Date(),complete:!1}}})),b=Object(i.a)(u,2),h=b[0],m=b[1];return Object(r.useEffect)((function(){h&&h.data&&!1===h.isLoading&&s({type:"CREATE_ITEM",title:h.data.title,description:h.data.description,createdTime:h.data.createdTime,complete:h.data.complete,id:h.data.id})}),[h]),Object(O.jsxs)("div",{children:[Object(O.jsx)("h3",{children:"Create a new To-Do Item:"}),Object(O.jsxs)("form",{onSubmit:function(e){e.preventDefault(),function(e){m({title:e.title,description:e.description})}(c)},children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{htmlFor:"create-title",children:"Title: "}),Object(O.jsx)("input",{type:"text",value:c.title,onChange:function(e){return a(Object(o.a)(Object(o.a)({},c),{},{title:e.target.value}))},name:"create-title",id:"create-title"})]}),Object(O.jsxs)("div",{children:[Object(O.jsx)("label",{htmlFor:"create-description",children:"Description: "}),Object(O.jsx)("br",{}),Object(O.jsx)("textarea",{name:"create-description",value:c.description,onChange:function(e){return a(Object(o.a)(Object(o.a)({},c),{},{description:e.target.value}))},id:"create-description"})]}),Object(O.jsx)("div",{children:Object(O.jsx)("input",{type:"submit",value:"Create",onChange:!0})})]})]})}var k=c(119),I=c(117);function _(e){var t=e.show,c=e.handleClose,a=Object(r.useContext)(l).dispatch,n=Object(r.useState)(""),s=Object(i.a)(n,2),o=s[0],d=s[1],u=Object(r.useState)(""),h=Object(i.a)(u,2),m=h[0],p=h[1],x=Object(r.useState)(!1),f=Object(i.a)(x,2),g=f[0],v=f[1],C=Object(j.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),y=Object(i.a)(C,2),T=y[0],w=y[1];return Object(r.useEffect)((function(){T&&!1===T.isLoading&&(T.data||T.error)&&(T.error?(v(!0),alert("failed")):(v(!1),a({type:"LOGIN",username:o,access_token:T.data.access_token})))}),[T]),Object(O.jsx)(k.a,{show:t,hide:c,children:Object(O.jsxs)(I.a,{onSubmit:function(e){e.preventDefault(),w(o,m),c()},children:[Object(O.jsx)(k.a.Header,{closeButton:!0,children:Object(O.jsx)(k.a.Title,{children:"Login"})}),Object(O.jsxs)(k.a.Body,{children:[Object(O.jsx)(I.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(O.jsx)(I.a.Control,{type:"text",value:o,onChange:function(e){return d(e.target.value)},name:"login-username",id:"login-username"}),Object(O.jsx)(I.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(O.jsx)(I.a.Control,{type:"password",value:m,onChange:function(e){return p(e.target.value)},name:"login-password",id:"login-password"}),g&&Object(O.jsx)("span",{style:{color:"red"},children:"Invalid username or password"})]}),Object(O.jsxs)(k.a.Footer,{children:[Object(O.jsx)(b.a,{variant:"secondary",onClick:c,children:"Cancel"}),Object(O.jsx)(b.a,{type:"submit",disabled:0===o.length||0===m.length,children:"Login"})]})]})})}function S(){var e=Object(r.useContext)(l),t=e.state,c=e.dispatch;return Object(O.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c({type:"LOGOUT"})},children:["Logged in as: ",Object(O.jsxs)("b",{children:[t.user.username," "]}),Object(O.jsx)("input",{type:"submit",value:"Logout"})]})}function R(e){var t=e.show,c=e.handleClose,a=Object(r.useState)({username:"",password:"",passwordRepeat:""}),n=Object(i.a)(a,2),s=n[0],d=n[1],u=(Object(r.useContext)(l).dispatch,Object(r.useState)("")),h=Object(i.a)(u,2),m=(h[0],h[1]),p=Object(j.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordRepeat:t}}})),x=Object(i.a)(p,2),f=x[0],g=x[1];return Object(r.useEffect)((function(){f&&!1===f.isLoading&&(f.data||f.error)&&(f.error?(m("Registration failed, please try again later."),alert("fail")):(m("Registration successful. You may now login."),alert("success")))}),[f]),Object(O.jsx)(k.a,{show:t,hide:c,children:Object(O.jsxs)(I.a,{onSubmit:function(e){e.preventDefault(),g(s.username,s.password),c()},children:[Object(O.jsx)(k.a.Header,{closeButton:!0,children:Object(O.jsx)(k.a.Title,{children:"Register"})}),Object(O.jsxs)(k.a.Body,{children:[Object(O.jsx)(I.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(O.jsx)(I.a.Control,{type:"text",value:s.username,onChange:function(e){return d(Object(o.a)(Object(o.a)({},s),{},{username:e.target.value}))},name:"register-username",id:"register_username"}),Object(O.jsx)(I.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(O.jsx)(I.a.Control,{type:"password",value:s.password,onChange:function(e){return d(Object(o.a)(Object(o.a)({},s),{},{password:e.target.value}))},name:"register-password",id:"register-password"}),Object(O.jsx)(I.a.Label,{htmlFor:"register-password-repeat",children:"Re-type password:"}),Object(O.jsx)(I.a.Control,{type:"password",value:s.passwordRepeat,onChange:function(e){return d(Object(o.a)(Object(o.a)({},s),{},{passwordRepeat:e.target.value}))},name:"register-password-repeat",id:"register-password-repeat"})]}),Object(O.jsxs)(k.a.Footer,{children:[Object(O.jsx)(b.a,{variant:"secondary",onClick:c,children:"Cancel"}),Object(O.jsx)(b.a,{type:"submit",disabled:0===s.username.length|0===s.password.length|s.password!==s.passwordRepeat,children:"Register"})]})]})})}function D(){var e=Object(r.useContext)(l).state,t=Object(r.useState)(!1),c=Object(i.a)(t,2),a=c[0],n=c[1],s=Object(r.useState)(!1),o=Object(i.a)(s,2),d=o[0],j=o[1];return e.user.username?Object(O.jsx)(S,{}):Object(O.jsxs)("div",{className:"justify-content-end",children:[Object(O.jsx)(b.a,{onClick:function(e){return n(!0)},children:"Login"}),Object(O.jsx)(_,{show:a,handleClose:function(){return n(!1)}}),Object(O.jsx)(b.a,{onClick:function(e){return j(!0)},children:"Register"}),Object(O.jsx)(R,{show:d,handleClose:function(){return j(!1)}})]})}var F=c(120);function M(e){var t=e.setTheme,c=Object(r.useContext)(d);Object(r.useContext)(l).state.user;return Object(O.jsx)(O.Fragment,{children:Object(O.jsx)(C.a,{bg:"light",expand:"lg",children:Object(O.jsxs)(v.a,{children:[Object(O.jsx)(C.a.Brand,{children:Object(O.jsx)(y,{text:"My To-Do List"})}),Object(O.jsx)(C.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(O.jsxs)(C.a.Collapse,{id:"basic-navbar-nav",children:[Object(O.jsx)(F.a,{className:"me-auto",children:Object(O.jsx)(F.a.Link,{children:Object(O.jsx)(L,{theme:c,setTheme:t})})}),Object(O.jsx)(a.a.Suspense,{fallback:"Loading...",children:Object(O.jsx)(D,{})})]})]})})})}function B(){var e=Object(r.useContext)(l),t=e.state,c=e.dispatch,a=Object(j.b)((function(){return{url:"/item/get",method:"get",headers:{Authorization:"".concat(t.user.access_token)}}})),n=Object(i.a)(a,2),s=n[0],o=n[1];return Object(r.useEffect)(o,{}),Object(r.useEffect)((function(){s&&!1===s.isLoading&&(s.error||s.data)&&(s.error?console.log(s.error.message()):c({type:"FETCH_ITEMS",items:s.data.reverse()}))}),[s]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(E,{}),Object(O.jsx)("br",{}),s.isLoading&&"To-Do Items Loading"," ",Object(O.jsx)(m,{})]})}var G=function(){var e=Object(r.useReducer)(g,{user:{},items:[]}),t=Object(i.a)(e,2),c=t[0],a=t[1],n=c.user,s=Object(r.useState)({primaryColor:"deepskyblue",secondaryColor:"coral"}),o=Object(i.a)(s,2),j=o[0],u=o[1];return Object(r.useEffect)((function(){n.username?document.title="".concat(n.username,"'s To-Do List"):document.title="To-Do List"}),[n]),Object(O.jsx)("div",{children:Object(O.jsx)(d.Provider,{value:j,children:Object(O.jsx)(l.Provider,{value:{state:c,dispatch:a},children:Object(O.jsxs)(v.a,{children:[Object(O.jsx)(M,{setTheme:u}),n.username&&Object(O.jsx)(B,{})]})})})})},A=c(43),U=c.n(A).a.create({baseURL:"/"});s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(j.a,{value:U,children:Object(O.jsx)(G,{})})}),document.getElementById("root"))}},[[109,1,2]]]);
//# sourceMappingURL=main.a965d3ec.chunk.js.map